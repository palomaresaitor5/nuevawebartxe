---
// Importing necessary components
import MainLayout from "@/layouts/MainLayout.astro";
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import CardSmall from "@components/ui/cards/CardSmall.astro";
import CardWide from "@components/ui/cards/CardWide.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import TestimonialsSectionAlt from "@components/sections/testimonials/TestimonialsSectionAlt.astro";

// Importing necessary functions from Astro
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { SITE } from "@data/constants";

// Fetching all the project related content and sorting it by main.id
const project: CollectionEntry<"projects">[] = (
  await getCollection("projects", ({ id }) => {
  return !id.includes("/"); // Get projects without language prefix (Spanish)
})).sort(
  (a: CollectionEntry<"projects">, b: CollectionEntry<"projects">) =>
    a.data.main.id - b.data.main.id
);

// Define variables for page content
const title: string = "Nuestros Proyectos";
const subTitle: string =
  "Explora nuestra cartera de proyectos web especializados por sectores. Cada proyecto está diseñado con precisión para satisfacer las necesidades específicas de diferentes industrias y profesionales.";

// Testimonial data that will be rendered in the component
const testimonials = [
  {
    content:
      "Artxe Web transformó completamente nuestra presencia online. El diseño especializado para nuestro despacho de abogados ha incrementado nuestras consultas en un 200%. La atención al detalle y el conocimiento del sector legal es excepcional.",
    author: "María José Fernández",
    role: "Socia Fundadora | Fernández & Asociados",
    avatarSrc:
      "https://images.unsplash.com/photo-1494790108755-2616b612b786?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "María José Fernández, Abogada",
  },
  {
    content:
      "Como electricista, necesitaba una web que transmitiera confianza y profesionalidad. Artxe Web no solo cumplió mis expectativas, sino que las superó. Ahora recibo llamadas de emergencia y solicitudes de presupuesto constantemente.",
    author: "Carlos Ruiz",
    role: "Electricista Certificado | ElectroRuiz",
    avatarSrc:
      "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Carlos Ruiz, Electricista",
  },
  {
    content:
      "La página web que me diseñó Artxe Web refleja perfectamente la solidez de mi trabajo como albañil. Los clientes ahora pueden ver la calidad de mis construcciones antes de contratarme. Ha sido una inversión excelente para mi negocio.",
    author: "Antonio García",
    role: "Maestro Albañil | Construcciones García",
    avatarSrc:
      "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Antonio García, Albañil",
  },
];

const pageTitle: string = `Proyectos | ${SITE.title}`;
const metaDescription =
  "Descubre nuestros proyectos web especializados por sectores: abogados, electricistas, albañiles y más. Diseños únicos que convierten visitantes en clientes.";
const ogTitle = "Proyectos Web Especializados | Artxe Web";
---

<MainLayout
  title={pageTitle}
  customDescription={metaDescription}
  customOgTitle={ogTitle}
  structuredData={{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://artxeweb.com/proyectos",
    url: "https://artxeweb.com/proyectos",
    name: "Proyectos Web Especializados | Artxe Web",
    description:
      "Descubre nuestros proyectos web especializados por sectores: abogados, electricistas, albañiles y más. Diseños únicos que convierten visitantes en clientes.",
    isPartOf: {
      "@type": "WebSite",
      url: "https://artxeweb.com",
      name: "Artxe Web",
      description:
        "Artxe Web: diseño y desarrollo de páginas web modernas, rápidas y optimizadas para SEO.",
    },
    inLanguage: "es",
  }}
>
  <div
    class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  >
    <div class="mb-4 flex items-center justify-between gap-8 sm:mb-8 md:mb-12">
      <div class="flex items-center gap-12">
        <h1
          class="text-2xl font-bold tracking-tight text-balance text-neutral-800 md:text-4xl md:leading-tight dark:text-neutral-200"
        >
          {title}
        </h1>
        {
          subTitle && (
            <p class="hidden max-w-(--breakpoint-sm) text-pretty text-neutral-600 md:block dark:text-neutral-400">
              {subTitle}
            </p>
          )
        }
      </div>
      <PrimaryCTA title="Historias de Clientes" url="#testimonials" noArrow={true} />
    </div>
    
    {/* Displaying projects in alternating styles. Alternative project gets different card styling.
    Maps through all project entries and displays them with either CardSmall or CardWide based on their position. */}
    <section class="grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6 xl:gap-8">
      {
        project.map((project, index) => {
          const position = index % 4;
          if (position === 0 || position === 3) {
            return <CardSmall product={project} />;
          } else {
            return <CardWide product={project} />;
          }
        })
      }
    </section>
  </div>
  
  {/* Features statistics section */}
  <FeaturesStatsAlt
    title="¿Por qué elegir nuestros proyectos especializados?"
    subTitle="Cada sector tiene sus propias necesidades y desafíos. Nuestros proyectos están diseñados específicamente para maximizar la conversión y el éxito en cada industria."
    benefits={[
      "Diseños especializados por sector profesional.",
      "Funcionalidades específicas para cada tipo de negocio.",
      "Optimización SEO adaptada a búsquedas sectoriales.",
      "Experiencia comprobada en múltiples industrias.",
    ]}
  />
  
  {/* Testimonials section */}
  <TestimonialsSectionAlt
    title="Lo que dicen nuestros clientes"
    testimonials={testimonials}
  />
</MainLayout>